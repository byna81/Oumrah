<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#059669">
    <title>Gestion Groupe Oumrah</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #d1fae5 0%, #99f6e4 50%, #a5f3fc 100%);
            min-height: 100vh;
            padding-bottom: 100px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        h1 {
            color: #047857;
            font-size: 28px;
            margin-bottom: 10px;
            text-align: center;
        }

        h2 {
            color: #047857;
            font-size: 22px;
            margin-bottom: 15px;
        }

        h3 {
            color: #059669;
            font-size: 18px;
            margin-bottom: 10px;
        }

        p {
            color: #4b5563;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        button {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #059669 0%, #0d9488 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(5, 150, 105, 0.3);
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            background: white;
            border: 2px solid #059669;
            color: #059669;
        }

        .btn-reset {
            background: #e5e7eb;
            color: #374151;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #d1d5db;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 15px;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #059669;
        }

        .hidden {
            display: none;
        }

        .rite-item {
            border: 2px solid #d1fae5;
            border-radius: 15px;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .rite-header {
            padding: 20px;
            background: white;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .rite-header:active {
            background: #f0fdf4;
        }

        .rite-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #059669 0%, #0d9488 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .rite-content {
            padding: 20px;
            background: #f0fdf4;
            border-top: 2px solid #d1fae5;
        }

        .dua-box {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #d1fae5;
        }

        .arabic-text {
            font-size: 24px;
            line-height: 1.8;
            text-align: right;
            direction: rtl;
            color: #1f2937;
        }

        .phonetic-text {
            font-style: italic;
            color: #6b7280;
            font-size: 14px;
        }

        .translation-text {
            color: #374151;
            font-size: 14px;
        }

        .counter-circle {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #059669 0%, #0d9488 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            box-shadow: 0 10px 30px rgba(5, 150, 105, 0.4);
        }

        .counter-number {
            font-size: 60px;
            font-weight: bold;
            color: white;
        }

        .success-box {
            background: #dcfce7;
            border: 2px solid #22c55e;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 15px;
        }

        .success-text {
            color: #166534;
            font-weight: bold;
            font-size: 16px;
        }

        .code-display {
            background: #d1fae5;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-family: monospace;
            font-size: 24px;
            font-weight: bold;
            color: #047857;
            margin: 15px 0;
        }

        .tab-bar {
            background: white;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            border: none;
            background: white;
            color: #6b7280;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            cursor: pointer;
        }

        .tab.active {
            color: #059669;
            border-bottom-color: #059669;
        }

        .header {
            background: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        .icon-circle {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #059669 0%, #0d9488 100%);
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(5, 150, 105, 0.3);
        }

        ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        ol li {
            margin-bottom: 8px;
            color: #374151;
        }

        .label {
            font-size: 12px;
            font-weight: 600;
            color: #047857;
            margin-bottom: 5px;
            display: block;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // État de l'application
        let state = {
            language: 'fr',
            userType: null,
            groupCode: '',
            currentGroup: null,
            activeTab: 'rites',
            expandedRite: null,
            tawafCount: 0,
            saiCount: 0,
            menuOpen: false
        };

        // Données des rites
        const rites = {
            fr: [
                {
                    id: 1,
                    title: "Ihram",
                    description: "État de sacralisation avant d'entrer dans les lieux saints",
                    steps: [
                        "Se purifier (ghusl) et porter les vêtements d'Ihram",
                        "Formuler l'intention (niyyah) pour la Oumrah",
                        "Réciter la Talbiyah"
                    ],
                    dua: {
                        arabic: "لَبَّيْكَ اللَّهُمَّ لَبَّيْكَ، لَبَّيْكَ لَا شَرِيكَ لَكَ لَبَّيْكَ، إِنَّ الْحَمْدَ وَالنِّعْمَةَ لَكَ وَالْمُلْكَ، لَا شَرِيكَ لَكَ",
                        phonetic: "Labbayka Allāhumma labbayk, labbayka lā sharīka laka labbayk, inna al-ḥamda wa n-niʿmata laka wa l-mulk, lā sharīka lak",
                        translation: "Me voici, Ô Allah, me voici. Me voici, Tu n'as pas d'associé, me voici. Certes la louange, la grâce et la royauté T'appartiennent. Tu n'as pas d'associé."
                    }
                },
                {
                    id: 2,
                    title: "Tawaf",
                    description: "Sept circumambulations autour de la Kaaba",
                    steps: [
                        "Commencer au niveau de la Pierre Noire (Hajar al-Aswad)",
                        "Effectuer 7 tours autour de la Kaaba dans le sens antihoraire",
                        "Toucher ou pointer la Pierre Noire à chaque tour si possible",
                        "Réciter les invocations pendant le Tawaf"
                    ],
                    dua: {
                        arabic: "سُبْحَانَ اللهِ وَالْحَمْدُ لِلَّهِ وَلَا إِلَهَ إِلَّا اللهُ وَاللهُ أَكْبَرُ وَلَا حَوْلَ وَلَا قُوَّةَ إِلَّا بِاللهِ",
                        phonetic: "Subḥāna Llāh, wa l-ḥamdu li-Llāh, wa lā ilāha illā Llāh, wa Llāhu akbar, wa lā ḥawla wa lā quwwata illā bi-Llāh",
                        translation: "Gloire à Allah, louange à Allah, il n'y a de divinité qu'Allah, Allah est le Plus Grand, il n'y a de force ni de puissance qu'en Allah."
                    }
                },
                {
                    id: 3,
                    title: "Prière de deux unités",
                    description: "Prière derrière Maqam Ibrahim",
                    steps: [
                        "Se diriger vers Maqam Ibrahim après le Tawaf",
                        "Accomplir deux rak'at (unités de prière)",
                        "Réciter sourate Al-Kafirun dans la 1ère rak'a",
                        "Réciter sourate Al-Ikhlas dans la 2ème rak'a"
                    ],
                    dua: {
                        arabic: "رَبَّنَا تَقَبَّلْ مِنَّا إِنَّكَ أَنْتَ السَّمِيعُ الْعَلِيمُ",
                        phonetic: "Rabbanā taqabbal minnā innaka anta s-samīʿu l-ʿalīm",
                        translation: "Notre Seigneur, accepte de nous, Tu es certes Celui qui entend et qui sait."
                    }
                },
                {
                    id: 4,
                    title: "Sa'i",
                    description: "Sept allers-retours entre Safa et Marwa",
                    steps: [
                        "Commencer à Safa en regardant la Kaaba",
                        "Marcher vers Marwa (1er trajet)",
                        "Retourner vers Safa (2ème trajet)",
                        "Répéter jusqu'à compléter 7 trajets (fin à Marwa)"
                    ],
                    dua: {
                        arabic: "إِنَّ الصَّفَا وَالْمَرْوَةَ مِنْ شَعَائِرِ اللَّهِ",
                        phonetic: "Inna ṣ-ṣafā wa l-marwata min shaʿāʾiri Llāh",
                        translation: "Certes Safa et Marwa sont parmi les rites d'Allah."
                    }
                },
                {
                    id: 5,
                    title: "Taqsir ou Halq",
                    description: "Raccourcir ou raser les cheveux",
                    steps: [
                        "Les hommes peuvent raser (Halq) ou raccourcir (Taqsir) leurs cheveux",
                        "Les femmes coupent l'équivalent d'une phalange de leurs cheveux",
                        "Ceci marque la fin de la Oumrah",
                        "L'état d'Ihram prend fin"
                    ],
                    dua: {
                        arabic: "الْحَمْدُ لِلَّهِ الَّذِي قَضَى عَنَّا نُسُكَنَا",
                        phonetic: "Al-ḥamdu li-Llāhi lladhī qaḍā ʿannā nusukana",
                        translation: "Louange à Allah qui nous a permis d'accomplir notre rite."
                    }
                }
            ],
            en: [
                {
                    id: 1,
                    title: "Ihram",
                    description: "State of consecration before entering the holy sites",
                    steps: [
                        "Perform purification (ghusl) and wear Ihram garments",
                        "Make intention (niyyah) for Umrah",
                        "Recite the Talbiyah"
                    ],
                    dua: {
                        arabic: "لَبَّيْكَ اللَّهُمَّ لَبَّيْكَ، لَبَّيْكَ لَا شَرِيكَ لَكَ لَبَّيْكَ، إِنَّ الْحَمْدَ وَالنِّعْمَةَ لَكَ وَالْمُلْكَ، لَا شَرِيكَ لَكَ",
                        phonetic: "Labbayka Allāhumma labbayk, labbayka lā sharīka laka labbayk, inna al-ḥamda wa n-niʿmata laka wa l-mulk, lā sharīka lak",
                        translation: "Here I am, O Allah, here I am. Here I am, You have no partner, here I am. Verily, all praise, grace and sovereignty belong to You. You have no partner."
                    }
                },
                {
                    id: 2,
                    title: "Tawaf",
                    description: "Seven circumambulations around the Kaaba",
                    steps: [
                        "Start at the Black Stone (Hajar al-Aswad)",
                        "Perform 7 circles around the Kaaba counterclockwise",
                        "Touch or point to the Black Stone each round if possible",
                        "Recite invocations during Tawaf"
                    ],
                    dua: {
                        arabic: "سُبْحَانَ اللهِ وَالْحَمْدُ لِلَّهِ وَلَا إِلَهَ إِلَّا اللهُ وَاللهُ أَكْبَرُ وَلَا حَوْلَ وَلَا قُوَّةَ إِلَّا بِاللهِ",
                        phonetic: "Subḥāna Llāh, wa l-ḥamdu li-Llāh, wa lā ilāha illā Llāh, wa Llāhu akbar, wa lā ḥawla wa lā quwwata illā bi-Llāh",
                        translation: "Glory be to Allah, praise be to Allah, there is no god but Allah, Allah is the Greatest, there is no power nor strength except with Allah."
                    }
                },
                {
                    id: 3,
                    title: "Two units prayer",
                    description: "Prayer behind Maqam Ibrahim",
                    steps: [
                        "Go to Maqam Ibrahim after Tawaf",
                        "Perform two rak'at (prayer units)",
                        "Recite Surah Al-Kafirun in the 1st rak'a",
                        "Recite Surah Al-Ikhlas in the 2nd rak'a"
                    ],
                    dua: {
                        arabic: "رَبَّنَا تَقَبَّلْ مِنَّا إِنَّكَ أَنْتَ السَّمِيعُ الْعَلِيمُ",
                        phonetic: "Rabbanā taqabbal minnā innaka anta s-samīʿu l-ʿalīm",
                        translation: "Our Lord, accept from us. Indeed, You are the Hearing, the Knowing."
                    }
                },
                {
                    id: 4,
                    title: "Sa'i",
                    description: "Seven trips between Safa and Marwa",
                    steps: [
                        "Start at Safa facing the Kaaba",
                        "Walk to Marwa (1st trip)",
                        "Return to Safa (2nd trip)",
                        "Repeat until completing 7 trips (ending at Marwa)"
                    ],
                    dua: {
                        arabic: "إِنَّ الصَّفَا وَالْمَرْوَةَ مِنْ شَعَائِرِ اللَّهِ",
                        phonetic: "Inna ṣ-ṣafā wa l-marwata min shaʿāʾiri Llāh",
                        translation: "Indeed, Safa and Marwa are among the symbols of Allah."
                    }
                },
                {
                    id: 5,
                    title: "Taqsir or Halq",
                    description: "Shortening or shaving the hair",
                    steps: [
                        "Men can shave (Halq) or shorten (Taqsir) their hair",
                        "Women cut the equivalent of a fingertip from their hair",
                        "This marks the end of Umrah",
                        "The state of Ihram ends"
                    ],
                    dua: {
                        arabic: "الْحَمْدُ لِلَّهِ الَّذِي قَضَى عَنَّا نُسُكَنَا",
                        phonetic: "Al-ḥamdu li-Llāhi lladhī qaḍā ʿannā nusukana",
                        translation: "Praise be to Allah who enabled us to complete our ritual."
                    }
                }
            ]
        };

        const t = {
            fr: {
                appTitle: "Gestion Groupe Oumrah",
                guide: "Guide",
                pilgrims: "Pèlerins",
                userType: "Choisissez votre rôle",
                create: "Créer un groupe",
                join: "Rejoindre",
                enterCode: "Entrez le code du groupe",
                yourCode: "Votre code de groupe :",
                shareCode: "Partagez ce code avec vos pèlerins",
                rites: "Rites",
                steps: "Étapes",
                invocation: "Invocation",
                phonetic: "Phonétique",
                translation: "Traduction",
                counter: "Compteur",
                round: "Tour",
                trip: "Trajet",
                reset: "Réinitialiser",
                tawafComplete: "Tawaf terminé ! 7 tours accomplis ✓",
                saiComplete: "Sa'i terminé ! 7 trajets accomplis ✓",
                back: "← Retour"
            },
            en: {
                appTitle: "Umrah Group Management",
                guide: "Guide",
                pilgrims: "Pilgrims",
                userType: "Choose your role",
                create: "Create group",
                join: "Join",
                enterCode: "Enter group code",
                yourCode: "Your group code:",
                shareCode: "Share this code with your pilgrims",
                rites: "Rites",
                steps: "Steps",
                invocation: "Invocation",
                phonetic: "Phonetic",
                translation: "Translation",
                counter: "Counter",
                round: "Round",
                trip: "Trip",
                reset: "Reset",
                tawafComplete: "Tawaf completed! 7 rounds done ✓",
                saiComplete: "Sa'i completed! 7 trips done ✓",
                back: "← Back"
            }
        };

        // Fonctions de rendu
        function render() {
            const app = document.getElementById('app');
            const lang = state.language;
            const tr = t[lang];

            if (!state.userType) {
                app.innerHTML = `
                    <div class="container">
                        <div class="card">
                            <div class="icon-circle">
                                <svg width="32" height="32" fill="white" viewBox="0 0 24 24">
                                    <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                                </svg>
                            </div>
                            <h1>${tr.appTitle}</h1>
                            <p style="text-align: center; margin-bottom: 30px;">${tr.userType}</p>
                            
                            <button class="btn-primary" onclick="selectUserType('guide')">${tr.guide}</button>
                            <button class="btn-secondary" onclick="selectUserType('pilgrim')">${tr.pilgrims}</button>
                            
                            <div style="text-align: center; margin-top: 20px;">
                                <select onchange="changeLanguage(this.value)" style="width: auto; display: inline-block;">
                                    <option value="fr" ${lang === 'fr' ? 'selected' : ''}>Français</option>
                                    <option value="en" ${lang === 'en' ? 'selected' : ''}>English</option>
                                </select>
                            </div>
                        </div>
                    </div>
                `;
            } else if (!state.currentGroup) {
                app.innerHTML = `
                    <div class="container">
                        <div class="card">
                            <button class="btn-secondary" onclick="goBack()" style="margin-bottom: 20px;">${tr.back}</button>
                            <h2>${state.userType === 'guide' ? tr.create : tr.join}</h2>
                            
                            ${state.userType === 'guide' ? `
                                <button class="btn-primary" onclick="createGroup()">${tr.create}</button>
                            ` : `
                                <input type="text" id="codeInput" placeholder="${tr.enterCode}" maxlength="6" style="text-transform: uppercase; text-align: center; font-size: 20px;">
                                <button class="btn-primary" onclick="joinGroup()">${tr.join}</button>
                            `}
                        </div>
                    </div>
                `;
            } else {
                const currentRites = rites[lang];
                app.innerHTML = `
                    <div class="header">
                        <h1 style="margin-bottom: 5px;">${tr.appTitle}</h1>
                        <p style="text-align: center; color: #6b7280;">${state.userType === 'guide' ? tr.guide : tr.pilgrims}</p>
                        <div class="code-display">${state.currentGroup}</div>
                        <p style="text-align: center; font-size: 12px; color: #6b7280;">${tr.shareCode}</p>
                        <div style="text-align: center; margin-top: 15px;">
                            <select onchange="changeLanguage(this.value)" style="width: auto; display: inline-block;">
                                <option value="fr" ${lang === 'fr' ? 'selected' : ''}>Français</option>
                                <option value="en" ${lang === 'en' ? 'selected' : ''}>English</option>
                            </select>
                        </div>
                    </div>

                    <div class="container">
                        <h2 style="margin-bottom: 20px;">${tr.rites}</h2>
                        ${currentRites.map((rite, index) => `
                            <div class="rite-item">
                                <div class="rite-header" onclick="toggleRite(${rite.id})">
                                    <div style="display: flex; align-items: center; flex: 1;">
                                        <div class="rite-number">${index + 1}</div>
                                        <div>
                                            <h3 style="margin: 0;">${rite.title}</h3>
                                            <p style="margin: 5px 0 0 0; font-size: 14px;">${rite.description}</p>
                                        </div>
                                    </div>
                                    <div style="font-size: 24px; color: #059669;">${state.expandedRite === rite.id ? '−' : '+'}</div>
                                </div>
                                
                                <div class="rite-content ${state.expandedRite === rite.id ? '' : 'hidden'}">
                                    <h3>${tr.steps}</h3>
                                    <ol>
                                        ${rite.steps.map(step => `<li>${step}</li>`).join('')}
                                    </ol>
                                    
                                    <h3 style="margin-top: 20px;">${tr.invocation}</h3>
                                    
                                    <div class="dua-box">
                                        <div class="arabic-text">${rite.dua.arabic}</div>
                                    </div>
                                    
                                    <div class="dua-box">
                                        <span class="label">${tr.phonetic}</span>
                                        <div class="phonetic-text">${rite.dua.phonetic}</div>
                                    </div>
                                    
                                    <div class="dua-box">
                                        <span class="label">${tr.translation}</span>
                                        <div class="translation-text">${rite.dua.translation}</div>
                                    </div>
                                    
                                    ${rite.id === 2 ? `
                                        <div style="margin-top: 20px; background: white; padding: 20px; border-radius: 15px; border: 2px solid #059669;">
                                            <h3 style="text-align: center;">${tr.counter}</h3>
                                            <div class="counter-circle">
                                                <div class="counter-number">${state.tawafCount}</div>
                                            </div>
                                            <p style="text-align: center; font-weight: 600; margin-bottom: 15px;">${tr.round} ${state.tawafCount}/7</p>
                                            ${state.tawafCount < 7 ? `
                                                <button class="btn-primary" onclick="incrementTawaf()">+ 1 ${tr.round}</button>
                                            ` : `
                                                <div class="success-box">
                                                    <div class="success-text">${tr.tawafComplete}</div>
                                                </div>
                                                <button class="btn-reset" onclick="resetTawaf()">${tr.reset}</button>
                                            `}
                                        </div>
                                    ` : ''}
                                    
                                    ${rite.id === 4 ? `
                                        <div style="margin-top: 20px; background: white; padding: 20px; border-radius: 15px; border: 2px solid #059669;">
                                            <h3 style="text-align: center;">${tr.counter}</h3>
                                            <div class="counter-circle">
                                                <div class="counter-number">${state.saiCount}</div>
                                            </div>
                                            <p style="text-align: center; font-weight: 600; margin-bottom: 15px;">${tr.trip} ${state.saiCount}/7</p>
                                            ${state.saiCount < 7 ? `
                                                <button class="btn-primary" onclick="incrementSai()">+ 1 ${tr.trip}</button>
                                            ` : `
                                                <div class="success-box">
                                                    <div class="success-text">${tr.saiComplete}</div>
                                                </div>
                                                <button class="btn-reset" onclick="resetSai()">${tr.reset}</button>
                                            `}
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
        }

        // Fonctions d'interaction
        function selectUserType(type) {
            state.userType = type;
            render();
        }

        function changeLanguage(lang) {
            state.language = lang;
            render();
        }

        function goBack() {
            state.userType = null;
            state.currentGroup = null;
            state.groupCode = '';
            render();
        }

        function createGroup() {
            const code = Math.random().toString(36).substring(2, 8).toUpperCase();
            state.currentGroup = code;
            state.groupCode = code;
            render();
        }

        function joinGroup() {
            const input = document.getElementById('codeInput');
            if (input && input.value.length >= 6) {
                state.currentGroup = input.value.toUpperCase();
                render();
            }
        }

        function toggleRite(id) {
            state.expandedRite = state.expandedRite === id ? null : id;
            render();
        }

        function incrementTawaf() {
            if (state.tawafCount < 7) {
                state.tawafCount++;
                render();
            }
        }

        function resetTawaf() {
            state.tawafCount = 0;
            render();
        }

        function incrementSai() {
            if (state.saiCount < 7) {
                state.saiCount++;
                render();
            }
        }

        function resetSai() {
            state.saiCount = 0;
            render();
        }

        // Initialisation
        render();
    </script>
</body>
</html>
